<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shop - SoundWell</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
      import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

      const supabase = createClient(
        "https://your-project-id.supabase.co",
        "your-anon-key"
      );

      const contenedor = document.getElementById("contenedor-productos");
      const filtroInput = document.getElementById("filtro");

      async function cargarProductos(filtro = "") {
        let query = supabase.from("productos").select("*");
        if (filtro && filtro !== "all") {
          query = query.ilike("categoria", `%${filtro}%`);
        }
        const { data, error } = await query;
        if (error) return console.error(error);

        contenedor.innerHTML = "";

        data.forEach((p) => {
          const card = document.createElement("a");
          card.href = `producto.html?producto=${p.slug}`;
          card.className = "flex flex-col gap-4 rounded-lg min-w-60 w-full sm:w-60";
          card.innerHTML = `
            <div
              class="aspect-square bg-cover bg-center rounded-xl"
              style="background-image: url('${p.imagen_url}')"
            ></div>
            <div>
              <p class="text-[#101418] text-base font-medium leading-normal">${p.nombre}</p>
              <p class="text-[#5c738a] text-sm font-normal leading-normal">${p.descripcion}</p>
            </div>
          `;
          contenedor.appendChild(card);
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        cargarProductos();

        filtroInput.addEventListener("change", (e) => {
          cargarProductos(e.target.value);
        });
      });
    </script>
  </head>
  <body class="bg-gray-50 font-sans">
    <div class="max-w-6xl mx-auto p-6">
      <div class="flex items-center justify-between mb-6">
        <h1 class="text-2xl font-bold text-[#101418]">Cat√°logo de Productos</h1>
        <select id="filtro" class="border rounded px-3 py-2 text-[#101418]">
          <option value="all">Todos</option>
          <option value="focus">Focus</option>
          <option value="sleep">Sleep</option>
          <option value="protect">Protect</option>
        </select>
      </div>
      <div id="contenedor-productos" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
      </div>
    </div>
  </body>
</html>
